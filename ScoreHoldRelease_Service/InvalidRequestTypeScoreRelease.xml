<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="baac2f36-bc85-4291-af1f-3f93e24ac17f" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="InvalidRequestTypeScoreRelease" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="da05e1f9-257b-4ef4-8c58-399da2375aaafileName">ScoreHold</con:setting><con:setting id="6e45caba-9702-4e05-8971-c4552a757bb6fileName">ScoreRelease</con:setting><con:setting id="baac2f36-bc85-4291-af1f-3f93e24ac17ffileName">InvalidRequestTypeScoreRelease</con:setting></con:settings><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="getData" id="d59b7bd5-5b05-4885-b822-0ff39ee8ef63"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>${#TestSuite#getData}</con:query><con:assertion type="XPath Match" id="1fe1723d-992c-4ce9-b566-b5f156f55749" name="Check count of [Row]"><con:configuration><path>count( //Results/ResultSet/Row)>0</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="2f5e64c7-1f08-45a4-b621-154489c28174"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ETS_APNTMT_ID</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>getData</con:sourceStep><con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/ETS_APNTMT_ID[1]</con:sourcePath><con:targetType>ETS_APNTMT_ID</con:targetType><con:targetStep>Properties</con:targetStep><con:targetPath/><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>BKNG_ID</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>getData</con:sourceStep><con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/BKNG_ID[1]</con:sourcePath><con:targetType>BKNG_ID</con:targetType><con:targetStep>Properties</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="properties" name="Properties" id="ad354414-52e2-45b2-9fb8-080f59c42ad9"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>ETS_APNTMT_ID</con:name><con:value>5852110170023148</con:value></con:property><con:property><con:name>BKNG_ID</con:name><con:value>4693783</con:value></con:property><con:property><con:name>REG_SYS_ID</con:name><con:value>ERS</con:value></con:property><con:property><con:name>REASON</con:name><con:value>SEC</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="ScoreHold" id="b07d2ff5-7f51-4e3c-9616-2e72ec99ccd1"><con:settings/><con:config service="ScoreHoldRelease" resourcePath="/ereg-appointment-service/rest/score/hold" methodName="Hold" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="ScoreHold" id="72c33481-1699-48b1-9571-f86468143830" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="password" value="1qaz@WSX"/>
  <con:entry key="SourceSystemId" value="ERS"/>
  <con:entry key="username" value="Intsyseregdvi"/>
  <con:entry key="Content-Type" value="application/json"/>
</xml-fragment>]]></con:setting></con:settings><con:request>{
    "sourceSystemId":"ERS",
    "appointmentIdList":[
        {
            "appointmentId":"${Properties#ETS_APNTMT_ID}",
            "regSysId":"${Properties#REG_SYS_ID}"
        }
    ],
    "requestType":"HLDNN",
    "reasonType":"${Properties#REASON}",
    "comment":"Test Hold"

}
</con:request><con:originalUri>https://v2-appointment-dev.ereg.ets.org/ereg-appointment-service/rest/score/hold</con:originalUri><con:assertion type="JsonPath Match" id="ddd80f37-7f3b-4a92-9708-80abe0507725" name="Match content of [appointmentId]"><con:configuration><path>$['appointmentStatusList'][0]['appointmentId']</path><content>${Properties#ETS_APNTMT_ID}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="b189db5c-33c4-420a-ac5a-fa1c0471c439" name="Match content of [appointmentStatus]"><con:configuration><path>$['appointmentStatusList'][0]['appointmentStatus']</path><content>SUCCESS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="c3db73e7-24f4-4e77-818b-adbfb2927a58" name="Match content of [regSysId]"><con:configuration><path>$['appointmentStatusList'][0]['regSysId']</path><content>ERS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="28fa68cf-15e7-4f4f-9521-b5e54d619e52" name="Check for existence of [appointmentTransactionId]"><con:configuration><path>$['appointmentStatusList'][0]['appointmentTransactionId']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:environmentSpec><con:entry environmentId="1616f813-7e88-44f3-9295-00c26c282621"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8d9a0c7e-6293-4ea0-ae89-48b18a6caf96"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="2c3ec9ec-bb1f-45d5-a8cc-50b0b05d3240"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8a20f3d0-3ddd-42c2-9e03-779de7421e8a"><con:authProfile>No Authorization</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="verify_HLD_table" id="0c569ce9-071b-493f-bc52-a471dffe1991"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>SELECT * FROM HLD WHERE bkng_id= ${Properties#BKNG_ID}  ORDER BY DATE_CREATED DESC </con:query><con:assertion type="XPath Match" id="5b684a69-7b82-4471-bf3a-c2d87f2b8a23" name="Match content of [SCR_HLD_TYP_CDE]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/SCR_HLD_TYP_CDE[1]/text()</path><content>SEC</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="verify_HLD_STS_table" id="2bb3de1d-8011-49c3-a54d-31ede63afbc7"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>SELECT * FROM HLD_STS WHERE HLD_ID IN (SELECT HLD_ID FROM HLD WHERE bkng_id= ${Properties#BKNG_ID} )  ORDER BY DATE_CREATED DESC </con:query><con:assertion type="XPath Match" id="349fdf2b-258c-4af7-bf10-f1f70f5ff14b" name="XPath Match"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/HLD_STS_TYP_CDE[1]/text()</path><content>HLDNN</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="aa41ee0b-4eae-47fa-b8e8-23b7dd85afb8" name="Match content of [SRC_SYS_ID]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/SRC_SYS_ID[1]/text()</path><content>ERS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="verify_HLD_CMNT_table" id="027a50a6-9dc0-4fc3-ae5c-b64a69cb9874"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>SELECT * FROM HLD_CMNT WHERE HLD_ID IN (SELECT HLD_ID FROM HLD WHERE bkng_id= ${Properties#BKNG_ID} )  ORDER BY DATE_CREATED DESC </con:query><con:assertion type="XPath Match" id="644f11f0-76a9-4b2e-b1c8-2d38afe58666" name="Match content of [CMNT]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/CMNT[1]/text()</path><content>Test Hold</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="ScoreRelease" id="49278fee-56be-449e-a22b-c1ee389311e2"><con:settings/><con:config service="ScoreHoldRelease" resourcePath="/ereg-appointment-service/rest/score/hold" methodName="Release" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="ScoreRelease" id="72c33481-1699-48b1-9571-f86468143830" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="password" value="1qaz@WSX"/>
  <con:entry key="SourceSystemId" value="ERS"/>
  <con:entry key="username" value="Intsyseregdvi"/>
  <con:entry key="Content-Type" value="application/json"/>
</xml-fragment>]]></con:setting></con:settings><con:endpoint>https://v2-appointment-dev.ereg.ets.org</con:endpoint><con:request>{
    "sourceSystemId":"ERS",
    "appointmentIdList":[
         {
            "appointmentId":"${Properties#ETS_APNTMT_ID}",
            "regSysId":"${Properties#REG_SYS_ID}"
        }
    ],
    "requestType":"RLSFF",
    "reasonType":"${Properties#REASON}",
    "comment":"Test Release"

}
</con:request><con:originalUri>https://v2-appointment-dev.ereg.ets.org/ereg-appointment-service/rest/score/hold</con:originalUri><con:assertion type="JsonPath Match" id="ae2753bc-6374-4eb6-939a-70e97aa09ad4" name="Match content of [appointmentStatus]"><con:configuration><path>$['appointmentStatusList'][0]['appointmentStatus']</path><content>null</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="e2a19fb6-c387-4044-89c4-80786426d6df" name="Match content of [regSysId]"><con:configuration><path>$['appointmentStatusList'][0]['regSysId']</path><content>ERS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="2dc0aca5-c1a2-4633-9f1f-7eaeb4854231" name="Match content of [appointmentId]"><con:configuration><path>$['appointmentStatusList'][0]['appointmentId']</path><content>${Properties#ETS_APNTMT_ID}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="9e7bff3d-a188-404f-adbd-9c00b9070f35" name="Check for existence of [appointmentTransactionId]"><con:configuration><path>$['appointmentStatusList'][0]['appointmentTransactionId']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="237e89e6-b544-4ba2-b715-688a5becd9f5" name="Match content of [errorDescription]"><con:configuration><path>$['errorMessages'][0]['errorDescription']</path><content>Invalid Request Type</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:environmentSpec><con:entry environmentId="1616f813-7e88-44f3-9295-00c26c282621"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8d9a0c7e-6293-4ea0-ae89-48b18a6caf96"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="2c3ec9ec-bb1f-45d5-a8cc-50b0b05d3240"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8a20f3d0-3ddd-42c2-9e03-779de7421e8a"><con:authProfile>No Authorization</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="verify_Release_HLD_table" id="53fc1cc6-8d80-4313-959e-1d29d387fa9f"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>SELECT * FROM HLD WHERE bkng_id= ${Properties#BKNG_ID}  ORDER BY DATE_CREATED DESC </con:query><con:assertion type="XPath Match" id="5b684a69-7b82-4471-bf3a-c2d87f2b8a23" name="Match content of [SCR_HLD_TYP_CDE]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/SCR_HLD_TYP_CDE[1]/text()</path><content>SEC</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="verify_Release_HLD_STS_table" id="b9491d7d-176a-41f9-bb7d-2b6af50745ba"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>SELECT * FROM HLD_STS WHERE HLD_ID IN (SELECT HLD_ID FROM HLD WHERE bkng_id= ${Properties#BKNG_ID} )  ORDER BY DATE_CREATED DESC </con:query><con:assertion type="XPath Match" id="349fdf2b-258c-4af7-bf10-f1f70f5ff14b" name="XPath Match"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/HLD_STS_TYP_CDE[1]/text()</path><content>HLDNN</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="aa41ee0b-4eae-47fa-b8e8-23b7dd85afb8" name="Match content of [SRC_SYS_ID]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/SRC_SYS_ID[1]/text()</path><content>ERS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="verify_Release_HLD_CMNT_table" id="9034b22a-0f46-4645-b320-96f426ff4c79"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:driver>${DB-Driver}</con:driver><con:connectionString>${Database}</con:connectionString><con:password/><con:query>SELECT * FROM HLD_CMNT WHERE HLD_ID IN (SELECT HLD_ID FROM HLD WHERE bkng_id= ${Properties#BKNG_ID} )  ORDER BY DATE_CREATED DESC </con:query><con:assertion type="XPath Match" id="644f11f0-76a9-4b2e-b1c8-2d38afe58666" name="Match content of [CMNT]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/CMNT[1]/text()</path><content>Test Hold</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="groovy" name="cleanUpData" id="380aac4b-636b-4de8-8be8-32cacde87321"><con:settings/><con:config><script>import cleanup.ScoreLoadService;
ScoreLoadService CleanData = new ScoreLoadService(testRunner.testCase.testSuite.project.activeEnvironment.name);

log.info CleanData.removeHoldStatus(context.expand( '${Properties#BKNG_ID}' ).toInteger());
</script></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>9d95bef3-a6b3-4ba3-83b4-439613ba1a15</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>ca6ca369-ef57-4922-8d91-514fbba72870</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>43f6b491-6dcc-4d7a-8fbf-9e3d77f7a71c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>7df82b00-c7a1-4d54-a209-6c7d24144ace</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>5e83f37a-2822-420b-9397-98ea02d05e67</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f1cf2278-0dbc-4cba-8701-380857c714ab</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:environmentSpec><con:entry environmentId="1616f813-7e88-44f3-9295-00c26c282621"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8d9a0c7e-6293-4ea0-ae89-48b18a6caf96"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="2c3ec9ec-bb1f-45d5-a8cc-50b0b05d3240"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:testCase>